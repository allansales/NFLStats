---
title: "Power Ranking Creation"
output: html_notebook
---

```{r}
library(caret)
library(tidyverse)
```

```{r}
games = read_csv("games_context.csv")
pr_model <- readRDS("power_ranking_variations.rds")
```

```{r}
last_season = max(games$Season)
last_week = max(games$Week)

games_last_week = games %>% filter(Week == last_week, Season == last_season)
games_context = games_last_week %>% ungroup() %>% select(-Date, -Team_target, -Team_adversary, -Season, -Week, -Day_of_week, -Type, -record, -record_adversary, -rank, -rank_adversary, -Rank_change_adversary, -n_ties, -n_ties_adversary, -Rank_change)
```

# Prediction
```{r}
prediction = predict(pr_model, games_context)
next_rank = (games_last_week$Previous_Rank + prediction) %>% rank()

a = data_frame(time = games_last_week$Team_target, rank_espn = games_last_week$rank, rank_modelo = next_rank)
```